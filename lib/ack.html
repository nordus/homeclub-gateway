<!DOCTYPE html><html lang="en"><head><title>lib/ack</title></head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0"><meta name="groc-relative-root" content="../"><meta name="groc-document-path" content="lib/ack"><meta name="groc-project-path" content="lib/ack.coffee"><meta name="groc-github-url" content="https://github.com/nordus/homeclub-gateway"><link rel="stylesheet" type="text/css" media="all" href="../assets/style.css"><script type="text/javascript" src="../assets/behavior.js"></script><body><div id="meta"><div class="file-path"><a href="https://github.com/nordus/homeclub-gateway/blob/master/lib/ack.coffee">lib/ack.coffee</a></div></div><div id="document"><div class="segment"><div class="comments "><div class="wrapper"><h1 id="ack">Ack</h1></div></div></div><div class="segment"><div class="code"><div class="wrapper"><span class="nv">dgram = </span><span class="nx">require</span> <span class="s1">&#39;dgram&#39;</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><ul>
<li><code>incomingMessageFromDevice</code>   : buffer. raw message from the device
example:
<code>&lt;Buffer 01 05 B8 21 67 80 07 00 0E 00 00 00 00 00 00 00 01 01 64 CF 00 AA 28 68 80 07 00 80 1C 00&gt;</code></li>
<li><code>rinfo</code> : object. contains <code>port</code> and <code>address</code> the message originated from</li>
</ul></div></div><div class="code"><div class="wrapper"><span class="nv">module.exports = </span><span class="nf">(incomingMessageFromDevice, rinfo) -&gt;</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><code>outgoingAckMsg</code>  : response to a successful decode</p></div></div><div class="code"><div class="wrapper">  <span class="nv">outgoingAckMsg = </span><span class="nx">Buffer</span><span class="p">.</span><span class="nx">concat</span> <span class="p">[</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><code>ACK</code> : string.
<code>&lt;Buffer 41 43 4b&gt;</code></p></div></div><div class="code"><div class="wrapper">    <span class="k">new</span> <span class="nx">Buffer</span><span class="p">(</span><span class="s1">&#39;ACK&#39;</span><span class="p">)</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><code>sequenceNumber</code>  : number.
possible values: 1 - 65535
rolls over to 1.</p></div></div><div class="code"><div class="wrapper">    <span class="nx">incomingMessageFromDevice</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><code>status</code>: number. 0: ERROR, 1: OK</p></div></div><div class="code"><div class="wrapper">    <span class="k">new</span> <span class="nx">Buffer</span><span class="p">([</span><span class="s2">&quot;0x01&quot;</span><span class="p">])</span>
  <span class="p">]</span>

  <span class="nv">sock = </span><span class="nx">dgram</span><span class="p">.</span><span class="nx">createSocket</span> <span class="s1">&#39;udp4&#39;</span>
  </div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>send using outbound port 2013</p></div></div><div class="code"><div class="wrapper">  <span class="nx">sock</span><span class="p">.</span><span class="nx">bind</span> <span class="mi">2013</span>
  
  <span class="nx">sock</span><span class="p">.</span><span class="nx">send</span> <span class="nx">outgoingAckMsg</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">outgoingAckMsg</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span> <span class="nx">rinfo</span><span class="p">.</span><span class="nx">port</span><span class="p">,</span> <span class="nx">rinfo</span><span class="p">.</span><span class="nx">address</span><span class="p">,</span> <span class="nf">(err, bytes) -&gt;</span>
    <span class="nx">sock</span><span class="p">.</span><span class="nx">close</span><span class="p">()</span></div></div></div></div></body></html>